{% extends "dashboard_base.html" %}
{% block title %}Create Exam{% endblock %}
{% block page_title %}Create Exam{% endblock %}
{% block content %}

<div class="grid-2">
  <div class="card-panel">
    <h3><i class="fas fa-file-circle-plus"></i> Exam Details</h3>
    <div class="form-group"><label>Exam Title</label><input type="text" class="form-input" placeholder="e.g. Python Basics Test" id="examTitle"></div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div class="form-group"><label>Subject</label><input type="text" class="form-input" placeholder="e.g. Python" id="examSubject"></div>
      <div class="form-group"><label>Duration (minutes)</label><input type="number" class="form-input" placeholder="60" id="examDuration"></div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div class="form-group"><label>Date</label><input type="date" class="form-input" id="examDate"></div>
      <div class="form-group"><label>Total Marks</label><input type="number" class="form-input" placeholder="100" id="examMarks"></div>
    </div>
  </div>

  <div class="card-panel">
    <h3><i class="fas fa-info-circle"></i> Instructions</h3>
    <div style="display:flex;flex-direction:column;gap:10px">
      <div style="padding:14px 16px;background:#eef2ff;border-radius:10px;border:1px solid #e0e7ff;font-size:13px;color:#4f46e5;display:flex;align-items:flex-start;gap:10px"><i class="fas fa-lightbulb" style="margin-top:2px"></i> Add questions one by one using the form below. Each question must have 4 options and one correct answer.</div>
      <div style="padding:14px 16px;background:#f0fdf4;border-radius:10px;border:1px solid #bbf7d0;font-size:13px;color:#16a34a;display:flex;align-items:flex-start;gap:10px"><i class="fas fa-check-circle" style="margin-top:2px"></i> You can add as many questions as needed. Click "Save Exam" when done.</div>
      <div style="padding:14px 16px;background:#fffbeb;border-radius:10px;border:1px solid #fde68a;font-size:13px;color:#d97706;display:flex;align-items:flex-start;gap:10px"><i class="fas fa-triangle-exclamation" style="margin-top:2px"></i> Make sure all fields are filled before saving the exam.</div>
    </div>
  </div>
</div>

<div class="card-panel" id="questionsContainer">
  <h3><i class="fas fa-list-ol"></i> Questions <span id="qCount" style="font-size:12px;color:#94a3b8;font-weight:400">(0 added)</span></h3>
  <div id="questionsList"></div>
  <div style="padding:20px;background:#f8fafc;border-radius:12px;border:1px solid #f1f5f9;margin-top:12px">
    <div class="form-group"><label>Question Text</label><input type="text" class="form-input" placeholder="Enter your question" id="qText"></div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div class="form-group"><label>Option A</label><input type="text" class="form-input" placeholder="Option A" id="optA"></div>
      <div class="form-group"><label>Option B</label><input type="text" class="form-input" placeholder="Option B" id="optB"></div>
      <div class="form-group"><label>Option C</label><input type="text" class="form-input" placeholder="Option C" id="optC"></div>
      <div class="form-group"><label>Option D</label><input type="text" class="form-input" placeholder="Option D" id="optD"></div>
    </div>
    <div class="form-group"><label>Correct Answer</label>
      <select class="form-input" id="correctAns"><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option></select>
    </div>
    <button class="btn-primary btn-sm btn-green" onclick="addQuestion()" style="margin-top:4px"><i class="fas fa-plus"></i> Add Question</button>
  </div>
</div>

<div style="display:flex;gap:12px;margin-top:8px">
  <button class="btn-primary" onclick="saveExam()"><i class="fas fa-save"></i> Save Exam</button>
  <button class="btn-primary btn-danger" onclick="if(confirm('Clear all?')){questions=[];renderQ()}"><i class="fas fa-trash"></i> Clear All</button>
</div>

<script>
let questions=[];
function addQuestion(){
  const q=document.getElementById('qText').value;
  const a=document.getElementById('optA').value;
  const b=document.getElementById('optB').value;
  const c=document.getElementById('optC').value;
  const d=document.getElementById('optD').value;
  const ans=document.getElementById('correctAns').value;
  if(!q||!a||!b||!c||!d){alert('Please fill all fields');return}
  questions.push({q,a,b,c,d,ans});
  ['qText','optA','optB','optC','optD'].forEach(id=>document.getElementById(id).value='');
  renderQ();
}
function renderQ(){
  document.getElementById('qCount').textContent='('+questions.length+' added)';
  let html='';
  questions.forEach((item,i)=>{
    html+='<div style="padding:14px 16px;background:#f8fafc;border-radius:10px;border:1px solid #f1f5f9;margin-bottom:8px;display:flex;align-items:center;gap:12px">'
      +'<div style="width:32px;height:32px;border-radius:8px;background:linear-gradient(135deg,#6366f1,#4f46e5);display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;font-weight:700;flex-shrink:0">'+(i+1)+'</div>'
      +'<div style="flex:1"><div style="font-size:13px;font-weight:500;color:#1e293b">'+item.q+'</div><div style="font-size:11px;color:#94a3b8;margin-top:2px">Answer: '+item.ans+'</div></div>'
      +'<button onclick="questions.splice('+i+',1);renderQ()" style="background:none;border:none;color:#ef4444;cursor:pointer;font-size:14px"><i class="fas fa-trash"></i></button></div>';
  });
  document.getElementById('questionsList').innerHTML=html;
}
function saveExam(){
  if(questions.length===0){alert('Add at least one question');return}
  alert('Exam saved with '+questions.length+' questions!');
}
</script>

{% endblock %}
