{% extends "dashboard_base.html" %}

{% block title %}Aptitude Test{% endblock %}
{% block page_title %}Aptitude Test{% endblock %}

{% block extra_css %}
.apt-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.apt-timer{background:rgba(239,68,68,.12);color:#f87171;padding:10px 20px;border-radius:12px;font-weight:600;display:inline-flex;align-items:center;gap:8px;border:1px solid rgba(239,68,68,.15)}
.apt-tabs{display:flex;gap:8px;margin-bottom:20px}
.apt-tab{padding:10px 20px;border-radius:10px;background:rgba(255,255,255,.06);cursor:pointer;font-weight:500;font-size:13px;border:1px solid rgba(255,255,255,.06);font-family:'Inter',sans-serif;transition:all .2s;color:rgba(255,255,255,.6)}
.apt-tab:hover{background:rgba(255,255,255,.1);color:#fff}
.apt-tab.active{background:linear-gradient(135deg,#6366f1,#4f46e5);color:#fff;border-color:transparent;box-shadow:0 2px 12px rgba(99,102,241,.3)}
.apt-section{display:none}
.apt-section.active{display:block}
.q-block{margin-bottom:18px;padding:20px;background:rgba(255,255,255,.04);border-radius:14px;border:1px solid rgba(255,255,255,.06)}
.q-block p{font-weight:600;color:#f1f5f9;margin-bottom:12px;font-size:14px}
.q-block label{display:block;margin:6px 0;cursor:pointer;font-size:14px;color:rgba(255,255,255,.65);padding:10px 14px;border-radius:10px;transition:all .2s;border:1px solid transparent}
.q-block label:hover{background:rgba(99,102,241,.08);border-color:rgba(99,102,241,.15);color:#f1f5f9}
.q-block label input{margin-right:10px;accent-color:#6366f1}
{% endblock %}

{% block content %}
<div class="dash-panel" style="max-width:800px">
  <div class="apt-header">
    <h3 style="margin-bottom:0"><i class="fas fa-brain" style="color:#c084fc"></i> Aptitude Test</h3>
    <div class="apt-timer"><i class="fas fa-clock"></i> <span id="aptTime">10:00</span></div>
  </div>

  <div class="apt-tabs">
    <button class="apt-tab active" onclick="showAptSection('quant',this)">Quantitative</button>
    <button class="apt-tab" onclick="showAptSection('logical',this)">Logical</button>
    <button class="apt-tab" onclick="showAptSection('verbal',this)">Verbal</button>
  </div>

  <div id="quant" class="apt-section active">
    <div class="q-block">
      <p>1. What is 25% of 200?</p>
      <label><input type="radio" name="q1" value="50"> 50</label>
      <label><input type="radio" name="q1" value="25"> 25</label>
    </div>
  </div>

  <div id="logical" class="apt-section">
    <div class="q-block">
      <p>2. Find the odd one out: Apple, Mango, Carrot</p>
      <label><input type="radio" name="q2" value="Carrot"> Carrot</label>
      <label><input type="radio" name="q2" value="Apple"> Apple</label>
    </div>
  </div>

  <div id="verbal" class="apt-section">
    <div class="q-block">
      <p>3. Choose the correct synonym of "Fast"</p>
      <label><input type="radio" name="q3" value="Quick"> Quick</label>
      <label><input type="radio" name="q3" value="Slow"> Slow</label>
    </div>
  </div>

  <div style="text-align:center;margin-top:24px">
    <button class="btn btn-success" style="padding:12px 30px" onclick="submitAptTest()"><i class="fas fa-paper-plane"></i> Submit Aptitude Test</button>
  </div>
</div>
{% endblock %}

{% block extra_js %}
let aptTotal = 600;
const aptTimerInterval = setInterval(()=>{
  let m=Math.floor(aptTotal/60), s=aptTotal%60;
  document.getElementById("aptTime").innerText = m+":"+String(s).padStart(2,"0");
  aptTotal--;
  if(aptTotal<0){ submitAptTest(); }
},1000);

function showAptSection(id, el){
  document.querySelectorAll(".apt-section").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll(".apt-tab").forEach(t=>t.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  el.classList.add("active");
}

function submitAptTest(){
  clearInterval(aptTimerInterval);
  let score=0;
  if(document.querySelector("input[name='q1']:checked")&&document.querySelector("input[name='q1']:checked").value==="50") score++;
  if(document.querySelector("input[name='q2']:checked")&&document.querySelector("input[name='q2']:checked").value==="Carrot") score++;
  if(document.querySelector("input[name='q3']:checked")&&document.querySelector("input[name='q3']:checked").value==="Quick") score++;
  let pct=Math.round((score/3)*100);
  alert("Aptitude Test Submitted! Score: "+pct+"%");
  window.location.href = "{{ url_for('exam_result') }}";
}
{% endblock %}
