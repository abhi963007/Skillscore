<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}Dashboard{% endblock %} | SkillScore</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#f1f5f9;color:#334155;display:flex;min-height:100vh}

/* Sidebar */
.sidebar{width:260px;background:#fff;border-right:1px solid #e2e8f0;display:flex;flex-direction:column;position:fixed;top:0;bottom:0;left:0;z-index:100;transition:transform .3s}
.sidebar-brand{padding:20px 24px;display:flex;align-items:center;gap:12px;border-bottom:1px solid #f1f5f9}
.sidebar-brand .logo-icon{width:40px;height:40px;background:linear-gradient(135deg,#6366f1,#4f46e5);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:17px;color:#fff;box-shadow:0 3px 10px rgba(99,102,241,.25)}
.sidebar-brand h2{font-size:18px;font-weight:800;color:#0f172a}
.sidebar-brand h2 span{color:#6366f1}

.sidebar-user{padding:18px 24px;display:flex;align-items:center;gap:12px;border-bottom:1px solid #f1f5f9}
.sidebar-user .avatar{width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,#6366f1,#4f46e5);display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:700;color:#fff;flex-shrink:0}
.sidebar-user .user-info h4{font-size:14px;font-weight:600;color:#1e293b;margin-bottom:1px}
.sidebar-user .user-info p{font-size:11px;color:#94a3b8;text-transform:capitalize;font-weight:500}

.sidebar-nav{flex:1;padding:16px 12px;overflow-y:auto}
.nav-label{font-size:10px;font-weight:600;color:#94a3b8;text-transform:uppercase;letter-spacing:1px;padding:8px 12px 6px;margin-top:8px}
.nav-label:first-child{margin-top:0}
.nav-item{display:flex;align-items:center;gap:12px;padding:10px 14px;border-radius:10px;font-size:13px;font-weight:500;color:#64748b;cursor:pointer;transition:all .2s;margin-bottom:2px}
.nav-item:hover{background:#f8fafc;color:#475569}
.nav-item.active{background:#eef2ff;color:#6366f1;font-weight:600}
.nav-item.active i{color:#6366f1}
.nav-item i{width:18px;font-size:15px;color:#94a3b8;transition:color .2s}
.nav-item:hover i{color:#64748b}

.sidebar-footer{padding:16px 12px;border-top:1px solid #f1f5f9}
.sidebar-footer .nav-item{color:#ef4444}
.sidebar-footer .nav-item i{color:#ef4444}
.sidebar-footer .nav-item:hover{background:#fef2f2}

/* Main Content */
.main{flex:1;margin-left:260px;display:flex;flex-direction:column;min-height:100vh}

/* Topbar */
.topbar{background:#fff;border-bottom:1px solid #e2e8f0;padding:14px 32px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:50}
.topbar h1{font-size:18px;font-weight:700;color:#0f172a}
.topbar-right{display:flex;align-items:center;gap:14px}
.topbar-pill{display:flex;align-items:center;gap:10px;padding:7px 16px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:10px;font-size:13px;color:#475569}
.topbar-pill i{color:#6366f1;font-size:14px}
.topbar-pill strong{font-weight:600;color:#1e293b}
.btn-logout{display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:10px;font-size:13px;font-weight:500;color:#ef4444;background:#fff;border:1px solid #fecaca;cursor:pointer;transition:all .2s;font-family:'Inter',sans-serif}
.btn-logout:hover{background:#fef2f2;border-color:#ef4444}

/* Content Area */
.content{flex:1;padding:28px 32px}

/* Flash Messages */
.flash-msg{padding:14px 18px;border-radius:12px;font-size:13px;font-weight:500;margin-bottom:20px;display:flex;align-items:center;gap:10px}
.flash-msg.success{background:#f0fdf4;color:#16a34a;border:1px solid #bbf7d0}
.flash-msg.danger{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}
.flash-msg.info{background:#eff6ff;color:#2563eb;border:1px solid #bfdbfe}

/* ===== Shared Dashboard Components ===== */
.welcome-banner{background:linear-gradient(135deg,#6366f1,#4f46e5);border-radius:16px;padding:28px 32px;display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;position:relative;overflow:hidden}
.welcome-banner::before{content:'';position:absolute;width:300px;height:300px;background:radial-gradient(circle,rgba(255,255,255,.08),transparent 70%);top:-150px;right:-50px}
.welcome-banner h2{font-size:22px;font-weight:700;color:#fff;margin-bottom:4px}
.welcome-banner p{font-size:14px;color:rgba(255,255,255,.7)}
.welcome-banner .wb-icon{font-size:48px;color:rgba(255,255,255,.15);position:relative;z-index:1}

.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}
.stat-card{background:#fff;border:1px solid #e2e8f0;border-radius:14px;padding:20px;display:flex;align-items:center;gap:16px;transition:all .3s}
.stat-card:hover{box-shadow:0 4px 16px rgba(0,0,0,.04);transform:translateY(-2px)}
.stat-card .sc-icon{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;color:#fff;flex-shrink:0}
.stat-card .sc-val{font-size:24px;font-weight:800;color:#0f172a}
.stat-card .sc-label{font-size:12px;color:#94a3b8;margin-top:2px}

.quick-links{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;margin-bottom:24px}
.ql-card{background:#fff;border:1px solid #e2e8f0;border-radius:14px;padding:20px 16px;text-align:center;transition:all .3s;cursor:pointer}
.ql-card:hover{box-shadow:0 4px 16px rgba(0,0,0,.04);transform:translateY(-3px);border-color:#c7d2fe}
.ql-card .ql-icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:18px;color:#fff;margin:0 auto 10px}
.ql-card .ql-label{font-size:12px;font-weight:600;color:#475569}

.card-panel{background:#fff;border:1px solid #e2e8f0;border-radius:14px;padding:24px;margin-bottom:20px}
.card-panel h3{font-size:15px;font-weight:600;color:#0f172a;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.card-panel h3 i{color:#6366f1;font-size:16px}

.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:20px}

/* Tables */
table{width:100%;border-collapse:collapse}
table th{font-size:11px;font-weight:600;color:#94a3b8;text-transform:uppercase;letter-spacing:.5px;padding:10px 14px;text-align:left;border-bottom:1px solid #f1f5f9}
table td{font-size:13px;color:#475569;padding:12px 14px;border-bottom:1px solid #f8fafc}
table tr:hover td{background:#fafbfc}
table .badge{display:inline-block;padding:4px 10px;border-radius:6px;font-size:11px;font-weight:600}
table .badge.green{background:#f0fdf4;color:#16a34a}
table .badge.red{background:#fef2f2;color:#dc2626}
table .badge.yellow{background:#fffbeb;color:#d97706}
table .badge.blue{background:#eff6ff;color:#2563eb}

/* Form Elements */
.form-group{margin-bottom:16px}
.form-group label{display:block;font-size:13px;font-weight:500;color:#475569;margin-bottom:6px}
.form-input{width:100%;padding:10px 14px;background:#fff;border:1.5px solid #e2e8f0;border-radius:10px;font-family:'Inter',sans-serif;font-size:14px;color:#1e293b;outline:none;transition:border-color .2s}
.form-input:focus{border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.08)}
.form-input::placeholder{color:#cbd5e1}
select.form-input{cursor:pointer}
textarea.form-input{resize:vertical;min-height:80px}

.btn-primary{padding:10px 22px;border-radius:10px;font-size:14px;font-weight:600;color:#fff;background:linear-gradient(135deg,#6366f1,#4f46e5);border:none;cursor:pointer;font-family:'Inter',sans-serif;box-shadow:0 2px 10px rgba(99,102,241,.25);transition:all .3s;display:inline-flex;align-items:center;gap:8px}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 16px rgba(99,102,241,.35)}
.btn-sm{padding:6px 14px;font-size:12px;border-radius:8px}
.btn-danger{background:linear-gradient(135deg,#ef4444,#dc2626);box-shadow:0 2px 10px rgba(239,68,68,.25)}
.btn-danger:hover{box-shadow:0 4px 16px rgba(239,68,68,.35)}
.btn-green{background:linear-gradient(135deg,#10b981,#059669);box-shadow:0 2px 10px rgba(16,185,129,.25)}
.btn-green:hover{box-shadow:0 4px 16px rgba(16,185,129,.35)}

/* Responsive */
@media(max-width:768px){
  .sidebar{transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .main{margin-left:0}
  .stats-row{grid-template-columns:repeat(2,1fr)}
  .grid-2{grid-template-columns:1fr}
  .quick-links{grid-template-columns:repeat(2,1fr)}
  .content{padding:20px 16px}
  .topbar{padding:14px 16px}
}
</style>
</head>
<body>

<!-- Sidebar -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-brand">
    <div class="logo-icon"><i class="fas fa-graduation-cap"></i></div>
    <h2>Skill<span>Score</span></h2>
  </div>
  <div class="sidebar-user">
    <div class="avatar">{{ session.get('user_name', 'U')[0] | upper }}</div>
    <div class="user-info">
      <h4>{{ session.get('user_name', 'User') }}</h4>
      <p>{{ session.get('role', 'user') }}</p>
    </div>
  </div>
  <nav class="sidebar-nav">
    {% if session.get('role') == 'admin' %}
    <div class="nav-label">Main</div>
    <a href="{{ url_for('admin_dashboard') }}" class="nav-item {{ 'active' if active_page == 'dashboard' }}"><i class="fas fa-th-large"></i> Dashboard</a>
    <div class="nav-label">Management</div>
    <a href="{{ url_for('manage_users') }}" class="nav-item {{ 'active' if active_page == 'manage_users' }}"><i class="fas fa-users-gear"></i> Manage Users</a>
    <a href="{{ url_for('all_exams') }}" class="nav-item {{ 'active' if active_page == 'all_exams' }}"><i class="fas fa-file-lines"></i> All Exams</a>
    <a href="{{ url_for('reports') }}" class="nav-item {{ 'active' if active_page == 'reports' }}"><i class="fas fa-chart-bar"></i> Reports</a>
    <a href="{{ url_for('audit_logs') }}" class="nav-item {{ 'active' if active_page == 'audit_logs' }}"><i class="fas fa-clipboard-list"></i> Audit Logs</a>
    <div class="nav-label">System</div>
    <a href="{{ url_for('settings') }}" class="nav-item {{ 'active' if active_page == 'settings' }}"><i class="fas fa-gear"></i> Settings</a>

    {% elif session.get('role') == 'teacher' %}
    <div class="nav-label">Main</div>
    <a href="{{ url_for('teacher_dashboard') }}" class="nav-item {{ 'active' if active_page == 'dashboard' }}"><i class="fas fa-th-large"></i> Dashboard</a>
    <a href="{{ url_for('profile') }}" class="nav-item {{ 'active' if active_page == 'profile' }}"><i class="fas fa-user"></i> Profile</a>
    <div class="nav-label">Teaching</div>
    <a href="{{ url_for('upload_notes') }}" class="nav-item {{ 'active' if active_page == 'upload_notes' }}"><i class="fas fa-cloud-arrow-up"></i> Upload Notes</a>
    <a href="{{ url_for('create_exam') }}" class="nav-item {{ 'active' if active_page == 'create_exam' }}"><i class="fas fa-file-circle-plus"></i> Create Exam</a>
    <a href="{{ url_for('view_results') }}" class="nav-item {{ 'active' if active_page == 'view_results' }}"><i class="fas fa-chart-column"></i> View Results</a>
    <div class="nav-label">Schedule</div>
    <a href="{{ url_for('exam_schedule') }}" class="nav-item {{ 'active' if active_page == 'exam_schedule' }}"><i class="fas fa-calendar-days"></i> Exam Schedule</a>
    <a href="{{ url_for('attendance') }}" class="nav-item {{ 'active' if active_page == 'attendance' }}"><i class="fas fa-clipboard-check"></i> Attendance</a>

    {% else %}
    <div class="nav-label">Main</div>
    <a href="{{ url_for('student_dashboard') }}" class="nav-item {{ 'active' if active_page == 'dashboard' }}"><i class="fas fa-th-large"></i> Dashboard</a>
    <a href="{{ url_for('profile') }}" class="nav-item {{ 'active' if active_page == 'profile' }}"><i class="fas fa-user"></i> Profile</a>
    <div class="nav-label">Learning</div>
    <a href="{{ url_for('subject_notes') }}" class="nav-item {{ 'active' if active_page == 'subject_notes' }}"><i class="fas fa-book"></i> Subject Notes</a>
    <a href="{{ url_for('placement_notes') }}" class="nav-item {{ 'active' if active_page == 'placement_notes' }}"><i class="fas fa-briefcase"></i> Placement Notes</a>
    <div class="nav-label">Assessment</div>
    <a href="{{ url_for('take_exam') }}" class="nav-item {{ 'active' if active_page == 'take_exam' }}"><i class="fas fa-file-pen"></i> Exams</a>
    <a href="{{ url_for('aptitude') }}" class="nav-item {{ 'active' if active_page == 'aptitude' }}"><i class="fas fa-brain"></i> Aptitude</a>
    <a href="{{ url_for('exam_result') }}" class="nav-item {{ 'active' if active_page == 'exam_result' }}"><i class="fas fa-square-poll-vertical"></i> Exam Results</a>
    <div class="nav-label">Tools</div>
    <a href="{{ url_for('upload') }}" class="nav-item {{ 'active' if active_page == 'upload' }}"><i class="fas fa-robot"></i> MCQ Generator</a>
    {% endif %}
  </nav>
  <div class="sidebar-footer">
    <a href="{{ url_for('logout') }}" class="nav-item"><i class="fas fa-right-from-bracket"></i> Logout</a>
  </div>
</aside>

<!-- Main -->
<div class="main">
  <header class="topbar">
    <h1>{% block page_title %}Dashboard{% endblock %}</h1>
    <div class="topbar-right">
      <div class="topbar-pill">
        <i class="fas fa-circle-user"></i>
        {{ session.get('user_name', 'User') }} &middot; <strong>{{ session.get('role', 'User') | capitalize }}</strong>
      </div>
      <a href="{{ url_for('logout') }}" class="btn-logout"><i class="fas fa-right-from-bracket"></i> Logout</a>
    </div>
  </header>
  <div class="content">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% for category, message in messages %}
        <div class="flash-msg {{ category }}"><i class="fas fa-{{ 'check-circle' if category == 'success' else 'exclamation-circle' }}"></i>{{ message }}</div>
      {% endfor %}
    {% endwith %}
    {% block content %}{% endblock %}
  </div>
</div>

</body>
</html>
